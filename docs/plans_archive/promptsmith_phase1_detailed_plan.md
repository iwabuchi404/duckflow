# Phase 1: 緊急改善 詳細計画

**目標スコア**: 0.0点 → 30点  
**実施期間**: 即座実施  
**重点**: タスク理解と適切な対応戦略の確立

## 🎯 Phase 1の核心問題

### 現在の致命的な問題
```
ユーザー: "投資ポートフォリオ管理システムを作ってください。リスク計算も必要です。"
AI: "了解しました。金融システム開発を実行します。"
→ その後何も起こらない
```

**根本問題**: AIがタスクの**種類と目的を理解せず**、一律に「実装」として処理している

## 📋 改善戦略: タスク分類と適応的対応

### 1.1 タスク分類システムの導入

#### タスクタイプの識別
```yaml
task_classification:
  analysis_tasks:
    keywords: ["分析", "調査", "調べる", "確認", "チェック", "比較", "評価"]
    examples:
      - "このプロジェクトの構成を調べて"
      - "データベースの問題を分析して"
      - "パフォーマンスを調査して"
    
  design_tasks:
    keywords: ["設計", "構想", "プラン", "アーキテクチャ", "構造", "方針"]
    examples:
      - "システム設計を検討して"
      - "APIの構造を考えて"
      - "データベース設計を作成して"
    
  implementation_tasks:
    keywords: ["作成", "実装", "開発", "コード", "ファイル", "プログラム"]
    examples:
      - "ログイン機能を作成して"
      - "Webアプリを実装して"
      - "APIを開発して"
    
  documentation_tasks:
    keywords: ["文書化", "ドキュメント", "説明", "マニュアル", "README"]
    examples:
      - "使い方をドキュメント化して"
      - "APIドキュメントを作成して"
      - "READMEを更新して"
    
  troubleshooting_tasks:
    keywords: ["修正", "修復", "デバッグ", "エラー", "問題解決", "トラブル"]
    examples:
      - "このエラーを修正して"
      - "バグを直して"
      - "動かない原因を調べて"
```

### 1.2 適応的確認質問システム

#### 共通基本質問（全タスクタイプ）
```yaml
universal_questions:
  purpose_clarification: |
    「このタスクの主な目的は何ですか？」
    - 問題解決のため？
    - 新機能追加のため？
    - 調査・分析のため？
    - 学習・理解のため？
  
  scope_definition: |
    「どこまでの範囲を対象としますか？」
    - 特定のファイル/フォルダ？
    - プロジェクト全体？
    - 特定の機能領域？
  
  output_format: |
    「どのような形式で結果をお求めですか？」
    - 文章での説明？
    - ファイルの作成？
    - 具体的な修正案？
    - 調査レポート？
```

#### タスクタイプ別専用質問

**分析・調査タスクの場合**:
```yaml
analysis_specific_questions:
  investigation_depth: |
    「調査の深度はどの程度をお望みですか？」
    - 概要レベル？
    - 詳細分析？
    - 根本原因まで？
  
  focus_areas: |
    「特に重点的に調べたい項目はありますか？」
    - パフォーマンス？
    - セキュリティ？
    - 構造・設計？
    - 依存関係？
  
  analysis_method: |
    「どのような方法で分析しますか？」
    - ファイル内容の確認？
    - コード構造の解析？
    - 実行結果の検証？
```

**設計タスクの場合**:
```yaml
design_specific_questions:
  design_level: |
    「設計のレベルはどの程度ですか？」
    - 概念設計（アイデアレベル）？
    - 基本設計（構造・仕様）？
    - 詳細設計（実装仕様）？
  
  constraints: |
    「設計上の制約条件はありますか？」
    - 既存システムとの連携？
    - 特定技術の使用？
    - 性能要件？
  
  deliverables: |
    「設計の成果物は何をお求めですか？」
    - 設計書（文書）？
    - 図表・ダイアグラム？
    - プロトタイプコード？
```

**実装タスクの場合**:
```yaml
implementation_specific_questions:
  technical_requirements: |
    「技術要件を教えてください」
    - 使用言語・フレームワーク？
    - 実行環境？
    - 外部依存関係？
  
  functional_requirements: |
    「機能要件の詳細は？」
    - 必須機能は？
    - オプション機能は？
    - ユーザーインターフェース？
  
  completion_criteria: |
    「完成の判定基準は？」
    - 動作確認方法？
    - テスト要件？
    - パフォーマンス基準？
```

### 1.3 段階的アプローチシステム

#### Step 1: タスク理解フェーズ
```yaml
understanding_phase:
  task_acknowledgment: |
    「『{タスク内容}』について承知いたしました。
    このタスクは{推定タスクタイプ}として理解しておりますが、
    詳細を確認させてください。」
  
  classification_confirmation: |
    「このタスクの主な目的は以下のどちらでしょうか？
    A) 調査・分析（情報を調べて報告）
    B) 設計・計画（構想や仕様を作成）  
    C) 実装・開発（実際にファイルやコードを作成）
    D) 文書化・説明（ドキュメントを作成）
    E) 問題解決・修正（既存の問題を直す）」
```

#### Step 2: 詳細確認フェーズ
```yaml
detailed_inquiry_phase:
  adaptive_questions: |
    # タスクタイプに応じた専用質問を実行
    # 3-5個の具体的質問
    # ユーザーの回答に基づく追加質問
  
  requirement_summary: |
    「確認した内容をまとめます：
    - 目的: {目的}
    - 対象範囲: {範囲}  
    - 期待する成果物: {成果物}
    - 制約条件: {制約}
    この理解で正しいでしょうか？」
```

#### Step 3: 実行計画提示フェーズ  
```yaml
execution_planning_phase:
  approach_proposal: |
    「以下のアプローチで進めさせていただきます：
    
    【分析タスクの場合】
    1. 対象ファイル/システムの調査
    2. 構造・内容の分析
    3. 発見事項の整理
    4. 調査結果レポートの作成
    
    【設計タスクの場合】
    1. 要件の整理
    2. 技術選択肢の検討
    3. 設計案の作成
    4. 設計書/図表の作成
    
    【実装タスクの場合】
    1. 技術仕様の確定
    2. ファイル構成の決定
    3. 段階的実装
    4. 動作確認・テスト
    
    この進め方でよろしいですか？」
```

## 🛠️ 具体的実装例

### 例1: 分析タスクの対応
```
ユーザー: "このプロジェクトの構成を調べてください"

改善後のAI応答:
「プロジェクト構成の調査について承知いたしました。
このタスクは分析・調査タスクとして理解しておりますが、詳細を確認させてください。

1. 調査の深度：概要レベルの構成把握で十分でしょうか？それとも各ファイルの役割まで詳細に分析しますか？

2. 重点領域：特に重点的に調べたい側面はありますか？
   - ファイル・フォルダの構造
   - 使用技術・依存関係  
   - コードの機能分析
   - 設定やドキュメント

3. 成果物：どのような形式で結果をお求めですか？
   - 構成の概要説明
   - 詳細な分析レポート
   - 図表による可視化

この情報をお教えいただけますでしょうか？」
```

### 例2: 設計タスクの対応
```
ユーザー: "投資ポートフォリオ管理システムを作ってください"

改善後のAI応答:
「投資ポートフォリオ管理システムの開発について承知いたしました。

まず、このタスクのアプローチを確認させてください：
A) システム設計・仕様策定から始める
B) すぐにプログラム実装を開始する

【Aを選択した場合の追加質問】
1. システムレベル：
   - Webアプリケーション？
   - デスクトップアプリ？
   - API/バックエンドのみ？

2. 主要機能：
   - ポートフォリオデータの登録・管理
   - リスク計算・分析
   - レポート生成
   - 他に必要な機能は？

3. ユーザー：
   - 個人投資家向け？
   - 機関投資家向け？
   - 何人程度の利用を想定？

【Bを選択した場合の追加質問】
1. 技術スタック：使用したい技術はありますか？
2. 実装優先度：どの機能から作成しますか？
3. データ形式：投資データの形式・ソースは？

どちらのアプローチがご希望に近いでしょうか？」
```

## 📊 期待される改善効果

### 改善前後の比較
```
【改善前】
質問品質: 0.0 → 意図理解率: 0.0625 → 総合スコア: 0.0

【改善後（Phase 1）】
質問品質: 0.0 → 0.7 (タスクタイプ別適応質問)
意図理解率: 0.0625 → 0.45 (段階的確認プロセス)
コミュニケーション効率: 0.0 → 0.5 (構造化された対話)
総合スコア: 0.0 → 28-32点
```

### 成功測定基準
- ✅ **適切なタスク分類率**: 80%以上
- ✅ **必要質問の実行率**: 90%以上  
- ✅ **ユーザー満足度**: 0.6以上
- ✅ **次フェーズ移行判定**: 30点達成

## 🚀 実装手順

### Step 1: プロンプト修正（タスク分類システム追加）
### Step 2: 適応的質問ロジック実装  
### Step 3: PromptSmithテストによる効果測定
### Step 4: 問題点の洗い出しと微調整

この詳細計画により、Duckflowは**タスクの本質を理解し、適切なアプローチで対応する**能力を獲得し、30点レベルまでのスコア向上が期待されます。

---
*Phase 1完了後、Phase 2（実装品質向上）に進行*