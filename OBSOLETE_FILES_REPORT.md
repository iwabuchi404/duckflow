# Duckflow リポジトリ クリーンアップ分析レポート

本レポートは、現在の Duckflow v4 (`companion`) アーキテクチャで使用されていない、リポジトリ内の不要なファイルおよびディレクトリを特定したものです。

## 調査結果の概要

リポジトリには、以前の開発フェーズ（Duckflow v3 / `codecrafter`）の遺産が大量に残っています。コアロジックのほとんどは `companion/` パッケージに移行されており、ルートディレクトリやいくつかのサブディレクトリには、冗長なスクリプト、古い設定ファイル、アーカイブ化されたドキュメントが混在しています。

---

## 🏗️ 1. レガシー・コア & パッケージ
これらは、以前の実行エンジンおよびその依存関係を構成していたものです。

| パス | 説明 | 推奨アクション |
| :--- | :--- | :--- |
| `codecrafter/` | 旧 v3 LangGraph 実装。 | アーカイブ / 削除 |
| `config/` | 旧設定ファイル（`config.yaml`など）。v4 は `duckflow.yaml` を使用。 | アーカイブ / 削除 |
| `reference_code/` | 旧メインループやユーティリティのアーカイブ。 | アーカイブ |
| `flowspec/` | 旧 LangGraph 用のフロー定義ファイル群。 | アーカイブ / 削除 |
| `dashboard/` | 未使用のプロトタイプ・ダッシュボード（Flaskベース）。 | アーカイブ / 削除 |
| `promptsmith/` | 開発初期に使用されたプロンプトエンジニアリングツール。 | アーカイブ / 削除 |
| `promptsmith_results/` | promptsmith ツールの出力結果。 | 削除 |

## 🧪 2. 一時スクリプト & デバッグスクリプト (ルート直下)
開発中に、特定の機能チェック、デバッグ、または修正のために一時的に作成されたスクリプトです。

| ファイル | 用途 | 推奨アクション |
| :--- | :--- | :--- |
| `add_vitals_check.py` | Pacemaker/Vitals ロジックのデバッグ用。 | 削除 |
| `debug_*.py` | パーサーや Sym-Ops 等の各種デバッグ用スクリプト。 | 削除 |
| `fix_*.py` | docstring、インデント、Vitals 等を修正するためのユーティリティ。 | 削除 |
| `test_*.py` | ルート直下のテストスクリプト（`companion` のテストに取って代わられています）。 | 削除 |
| `verify_*.py` | 特定のロジック検証用の使い捨てスクリプト。 | 削除 |
| `utils.py` | 旧ユーティリティ。現在は `companion/utils/` を使用。 | 削除 |
| `improve_fuzzy.py` | ファジーマッチングの実証実験用ロジック。 | 削除 |

## 📄 3. 冗長なドキュメント
既に `README.md` や `PROGRESS.md` に内容が統合された、古いマイルストーン報告や記録です。

| ファイル | 背景 | 推奨アクション |
| :--- | :--- | :--- |
| `PHASE1_SUCCESS_AND_NEXT_STEPS.md` | Phase 1 のマイルストーンレポート。 | アーカイブ |
| `MAIN_COMPANION_INTEGRATION_COMPLETE.md` | 統合完了時の確認レポート。 | アーカイブ |
| `action_mapping_*.md` | 一時的なロジックマッピング用ドキュメント。 | 削除 |
| `current_data_flow_diagram.md` | 旧アーキテクチャ図（内容が古いです）。 | アーカイブ |
| `improved_dual_loop_flow.md` | 旧バージョンのフロー設計メモ。 | アーカイブ |
| `plantool_symops_analysis.md` | ツール統合時の歴史的分析ドキュメント。 | アーカイブ |
| `DEMO_GUIDE.md` | 内容が古い可能性が高いデモガイド。 | 確認後、削除 |

## 🧪 4. 機能していないテスト
- **`tests/`**: このディレクトリ内のほとんどのファイルは `codecrafter.*` をインポートしており、現在の環境では動きません。これらは `legacy_tests/` フォルダへ移動するか、`companion` パッケージ用の新しいテストに置き換える必要があります。

---

## 🚀 推奨されるクリーンアップ手順

1. **アーカイブ**: `legacy_archive/` ディレクトリを作成し、重要なレガシーコア（`codecrafter`, `flowspec`, `reference_code`）やマイルストーン文書をそこへ移動します。
2. **削除**: 明らかに一時的なスクリプト（`debug_*.py`, `test_*.py`, `promptsmith_results/`）を削除します。
3. **同期**: `pyproject.toml` 内のメタデータ（現在は `name = "codecrafter"` となっています）を、必要に応じて実際のプロジェクト名に合わせて更新します。
4. **テストの再編**: `tests/` 内の有用なテストを、`companion` からインポートするように書き換えて新しい構造へ移行します。

> [!NOTE]
> まだアクションは実行されていません。このレポートはユーザーによる確認のためのものです。
